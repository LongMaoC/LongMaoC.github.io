<!DOCTYPE HTML>
<html>
<head>
  <title>无线传输</title>
  <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
</head>
<body >

<div style="font-family: 'Lucida Grande', 'Segoe UI', 'Apple SD Gothic Neo', 'Malgun Gothic', 'Lucida Sans Unicode', Helvetica, Arial, sans-serif; font-size: 0.9em; overflow-x: hidden; overflow-y: auto; margin: 0px !important; padding: 5px 20px 26px !important; background-color: rgb(255, 255, 255);font-family: 'Hiragino Sans GB', 'Microsoft YaHei', STHeiti, SimSun, 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', 'Segoe UI', AppleSDGothicNeo-Medium, 'Malgun Gothic', Verdana, Tahoma, sans-serif; padding: 20px;padding: 20px; color: rgb(34, 34, 34); font-size: 15px; font-family: 'Roboto Condensed', Tauri, 'Hiragino Sans GB', 'Microsoft YaHei', STHeiti, SimSun, 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', 'Segoe UI', AppleSDGothicNeo-Medium, 'Malgun Gothic', Verdana, Tahoma, sans-serif; line-height: 1.6; -webkit-font-smoothing: antialiased; background: rgb(255, 255, 255);"><h1 id="阿里路由-arouter-demo-分析" style="clear: both;font-size: 2.2em; font-weight: bold; margin: 1.5em 0px 1em;margin-top: 0px;"><a name="阿里路由-arouter-demo-分析" href="#阿里路由-arouter-demo-分析" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>阿里路由 ARouter-demo 分析</h1><p style="margin-top: 0px;margin: 1em 0px; word-wrap: break-word;">阿里路由可以用于组件化开发,所以,简单的看了下代码,分析下执行过程</p><h2 id="目录" style="clear: both;font-size: 1.8em; font-weight: bold; margin: 1.275em 0px 0.85em;border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(230, 230, 230);"><a name="目录" href="#目录" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>目录</h2><p style="undefined; margin: 0px !important;margin-top: 0px;margin: 1em 0px; word-wrap: break-word;"></p><ul>
<li style="display: list-item; line-height: 1.4em;"><ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#目录" title="目录" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">目录</a>
</span>
<!--span class="number">
0
</span-->
<ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#初始化" title="初始化" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">初始化</a>
</span>
<!--span class="number">
1
</span-->
<ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#使用" title="使用" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">使用</a>
</span>
<!--span class="number">
2
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#代码分析" title="代码分析" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">代码分析</a>
</span>
<!--span class="number">
3
</span-->
<ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#arouter-&gt;init(application)" title="ARouter->init(Application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">ARouter-&gt;init(Application)</a>
</span>
<!--span class="number">
4
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#_arouter-&gt;init(application)" title="_ARouter->init(Application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">_ARouter-&gt;init(Application)</a>
</span>
<!--span class="number">
5
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#logisticscenter-&gt;init(application)" title="LogisticsCenter->init(Application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">LogisticsCenter-&gt;init(Application)</a>
</span>
<!--span class="number">
6
</span-->
</li>
</ul>
</li>
</ul>
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#携带参数跳转" title="携带参数跳转" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">携带参数跳转</a>
</span>
<!--span class="number">
7
</span-->
<ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#使用-1" title="使用" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">使用</a>
</span>
<!--span class="number">
8
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#代码分析-1" title="代码分析" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">代码分析</a>
</span>
<!--span class="number">
9
</span-->
<ul>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#_arouter-&gt;build(string,string)" title="_ARouter->build(String,String)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">_ARouter-&gt;build(String,String)</a>
</span>
<!--span class="number">
10
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#_arouter-&gt;navigation(context,postcard,int,navigationcallback)" title="_ARouter->navigation(Context,Postcard,int,NavigationCallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">_ARouter-&gt;navigation(Context,Postcard,int,NavigationCallback)</a>
</span>
<!--span class="number">
11
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#logisticscenter-&gt;completion(postcard)" title="LogisticsCenter->completion(Postcard)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">LogisticsCenter-&gt;completion(Postcard)</a>
</span>
<!--span class="number">
12
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#_arouter-&gt;navigation(context,postcard,int,navigationcallback)-1" title="_ARouter->navigation(Context,Postcard,int,NavigationCallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">_ARouter-&gt;navigation(Context,Postcard,int,NavigationCallback)</a>
</span>
<!--span class="number">
13
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#interceptorserviceimpl-&gt;dointerceptions(postcard,-interceptorcallback)" title="InterceptorServiceImpl->doInterceptions(Postcard, InterceptorCallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">InterceptorServiceImpl-&gt;doInterceptions(Postcard, InterceptorCallback)</a>
</span>
<!--span class="number">
14
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#interceptorserviceimpl-&gt;_excute(int,-cancelablecountdownlatch,postcard)" title="InterceptorServiceImpl->_excute(int, CancelableCountDownLatch,Postcard)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">InterceptorServiceImpl-&gt;_excute(int, CancelableCountDownLatch,Postcard)</a>
</span>
<!--span class="number">
15
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#test1interceptor-&gt;process(postcard,interceptorcallback)" title="Test1Interceptor->process(Postcard,InterceptorCallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">Test1Interceptor-&gt;process(Postcard,InterceptorCallback)</a>
</span>
<!--span class="number">
16
</span-->
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#_arouter-&gt;_navigation(context,postcard,int,navigationcallback)" title="_ARouter->_navigation(Context,Postcard,int,NavigationCallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">_ARouter-&gt;_navigation(Context,Postcard,int,NavigationCallback)</a>
</span>
<!--span class="number">
17
</span-->
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li style="display: list-item; line-height: 1.4em;"><span class="title">
<a href="#end" title="END" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);">END</a>
</span>
<!--span class="number">
18
</span-->
</li>
</ul>
</li>

</ul>
<p style="margin: 1em 0px; word-wrap: break-word;"></p><h3 id="初始化" style="clear: both;font-size: 1.6em; font-weight: bold; margin: 1.125em 0px 0.75em;"><a name="初始化" href="#初始化" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>初始化</h3><h4 id="使用" style="clear: both;font-size: 1.4em; font-weight: bold; margin: 0.99em 0px 0.66em;"><a name="使用" href="#使用" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>使用</h4><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>ARouter.init(getApplication());
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">ARouter.init(getApplication());
</code></pre><h4 id="代码分析" style="clear: both;font-size: 1.4em; font-weight: bold; margin: 0.99em 0px 0.66em;"><a name="代码分析" href="#代码分析" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>代码分析</h4><p style="margin-top: 0px;margin: 1em 0px; word-wrap: break-word;">跟入到<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">ARouter.init()</code>方法内</p><h5 id="arouter->init(application)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="arouter->init(application)" href="#arouter-&gt;init(application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>ARouter-&gt;init(Application)</h5><p style="margin-top: 0px;margin: 1em 0px; word-wrap: break-word;"> 这个方法先根据变量判断是否需要初始化,然后做了两件事,一个是初始化log,一个是初始化<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_ARouter.init(application)</code></p><h5 id="_arouter->init(application)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="_arouter->init(application)" href="#_arouter-&gt;init(application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>_ARouter-&gt;init(Application)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>    protected static synchronized boolean init(Application application) {
        //.....
        LogisticsCenter.init(mContext, executor);
        //.....
        return true;
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">    protected static synchronized boolean init(Application application) {
        //.....
        LogisticsCenter.init(mContext, executor);
        //.....
        return true;
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">这里对LogisticsCenter进行初始化</p><h5 id="logisticscenter->init(application)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="logisticscenter->init(application)" href="#logisticscenter-&gt;init(application)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>LogisticsCenter-&gt;init(Application)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>     public synchronized static void init(Context context, ThreadPoolExecutor tpe) throws HandlerException {
        try {
            // These class was generate by arouter-compiler.
            List&amp;lt;String&amp;gt; classFileNames = ClassUtils.getFileNameByPackageName(mContext, ROUTE_ROOT_PAKCAGE);

            for (String className : classFileNames) {
               //根据起始字符串,判断是否需要加入到缓存中
            }

        } catch (Exception e) {

        }
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">     public synchronized static void init(Context context, ThreadPoolExecutor tpe) throws HandlerException {
        try {
            // These class was generate by arouter-compiler.
            List&lt;String&gt; classFileNames = ClassUtils.getFileNameByPackageName(mContext, ROUTE_ROOT_PAKCAGE);

            for (String className : classFileNames) {
               //根据起始字符串,判断是否需要加入到缓存中
            }

        } catch (Exception e) {

        }
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">整个初始化的过程主要对logger初始化,缓存初始化</p><h3 id="携带参数跳转" style="clear: both;font-size: 1.6em; font-weight: bold; margin: 1.125em 0px 0.75em;"><a name="携带参数跳转" href="#携带参数跳转" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>携带参数跳转</h3><h4 id="使用" style="clear: both;font-size: 1.4em; font-weight: bold; margin: 0.99em 0px 0.66em;"><a name="使用" href="#使用" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>使用</h4><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>ARouter.getInstance().build(&quot;/test/activity2&quot;).withString(&quot;key1&quot;, &quot;value1&quot;).navigation();
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">ARouter.getInstance().build("/test/activity2").withString("key1", "value1").navigation();
</code></pre><h4 id="代码分析" style="clear: both;font-size: 1.4em; font-weight: bold; margin: 0.99em 0px 0.66em;"><a name="代码分析" href="#代码分析" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>代码分析</h4><p style="margin-top: 0px;margin: 1em 0px; word-wrap: break-word;">获取ARouter的单例,然后调用build(String path),最终会进入build(String path, String group)这个方法</p><h5 id="_arouter->build(string,string)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="_arouter->build(string,string)" href="#_arouter-&gt;build(string,string)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>_ARouter-&gt;build(String,String)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>protected Postcard build(String path, String group) {//path的值为:&quot;/test/activity2&quot;,group的值为&quot;test&quot;;
        if (TextUtils.isEmpty(path) || TextUtils.isEmpty(group)) {
            throw new HandlerException(Consts.TAG + &quot;Parameter is invalid!&quot;);
        } else {
            //PathReplaceService 是用来解决运行期动态修改路由的问题;由于demo中没有它的实现类, 所以,pService==null; 最后直接返回Postcard对象
            PathReplaceService pService = ARouter.getInstance().navigation(PathReplaceService.class);
            if (null != pService) {
                path = pService.forString(path);
            }
            return new Postcard(path, group);
        }
    }


public final class Postcard extends RouteMeta {
    // Base
    private Uri uri;
    private Object tag;             // A tag prepare for some thing wrong.
    private Bundle mBundle;         // Data to transform
    private int flags = -1;         // Flags of route
    private int timeout = 300;      // Navigation timeout, TimeUnit.Second
    private IProvider provider;     // It will be set value, if this postcard was provider.
    private boolean greenChannel;
    private SerializationService serializationService;

    // Animation
    private Bundle optionsCompat;    // The transition animation of activity
    private int enterAnim;
    private int exitAnim;
}
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">protected Postcard build(String path, String group) {//path的值为:"/test/activity2",group的值为"test";
        if (TextUtils.isEmpty(path) || TextUtils.isEmpty(group)) {
            throw new HandlerException(Consts.TAG + "Parameter is invalid!");
        } else {
            //PathReplaceService 是用来解决运行期动态修改路由的问题;由于demo中没有它的实现类, 所以,pService==null; 最后直接返回Postcard对象
            PathReplaceService pService = ARouter.getInstance().navigation(PathReplaceService.class);
            if (null != pService) {
                path = pService.forString(path);
            }
            return new Postcard(path, group);
        }
    }


public final class Postcard extends RouteMeta {
    // Base
    private Uri uri;
    private Object tag;             // A tag prepare for some thing wrong.
    private Bundle mBundle;         // Data to transform
    private int flags = -1;         // Flags of route
    private int timeout = 300;      // Navigation timeout, TimeUnit.Second
    private IProvider provider;     // It will be set value, if this postcard was provider.
    private boolean greenChannel;
    private SerializationService serializationService;

    // Animation
    private Bundle optionsCompat;    // The transition animation of activity
    private int enterAnim;
    private int exitAnim;
}
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">Postcard 是一个包含了目标界面相关信息的类</p><p style="margin: 1em 0px; word-wrap: break-word;">返回Postcard后,调用了<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">.withString("key1", "value1")</code>方法,改方法用来香Postcard中的mBundle添加参数</p><p style="margin: 1em 0px; word-wrap: break-word;"><strong>重点来了,调用<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;">.navigation()</code>方法,会跟到_ARouter中的<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;">.navigation()</code>方法</strong></p><h5 id="_arouter->navigation(context,postcard,int,navigationcallback)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="_arouter->navigation(context,postcard,int,navigationcallback)" href="#_arouter-&gt;navigation(context,postcard,int,navigationcallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>_ARouter-&gt;navigation(Context,Postcard,int,NavigationCallback)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>protected Object navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback){//参数值 context:null;requestCode:-1;callback:null;
    LogisticsCenter.completion(postcard);
}
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">protected Object navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback){//参数值 context:null;requestCode:-1;callback:null;
    LogisticsCenter.completion(postcard);
}
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">然后调用<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">LogisticsCenter.completion(postcard);</code>方法</p><h5 id="logisticscenter->completion(postcard)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="logisticscenter->completion(postcard)" href="#logisticscenter-&gt;completion(postcard)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>LogisticsCenter-&gt;completion(Postcard)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code> public synchronized static void completion(Postcard postcard) {
        if (null == postcard) {
            throw new NoRouteFoundException(TAG + &quot;No postcard!&quot;);
        }
        //根据&quot;/test/activity2&quot;为key,去map中找,看是否有对应的RouteMeta
        RouteMeta routeMeta = Warehouse.routes.get(postcard.getPath());
        if (null == routeMeta) {    // Maybe its does't exist, or didn't load.
               //如果,没有这个具体路径,就执行下面代码.
            //根据组名去寻找,组的文件
            Class&amp;lt;? extends IRouteGroup&amp;gt; groupMeta = Warehouse.groupsIndex.get(postcard.getGroup());  // Load route meta.
            if (null == groupMeta) {
                //当前组名没有获取到,会抛出如下错误
                throw new NoRouteFoundException(TAG + &quot;There is no route match the path [&quot; + postcard.getPath() + &quot;], in group [&quot; + postcard.getGroup() + &quot;]&quot;);
            } else {
                // Load route and cache it into memory, then delete from metas.
                //获取到分组文件,groupMeta对应的文件为com.alibaba.android.arouter.routes.ARouter$$Group$$test
                try {
                    //....打印log
                    //获取这个文件,并实例出接口对象
                    IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();
                    //向Warehouse.routes中加载&quot;/test&quot;分组下的数据
                    iGroupInstance.loadInto(Warehouse.routes);
                    //索引列表中移除当前信息,因为已经添加到内存中
                    Warehouse.groupsIndex.remove(postcard.getGroup());

                    //....打印log
                } catch (Exception e) {
                    throw new HandlerException(TAG + &quot;Fatal exception when loading group meta. [&quot; + e.getMessage() + &quot;]&quot;);
                }
                //再一次调用compleyion(),此时Warehouse.routes中已经有&quot;/test/activity2&quot;对应界面的信息
                completion(postcard);   // Reload
            }
        } else {
            //第二次会走到这里,并对
            postcard.setDestination(routeMeta.getDestination());
            postcard.setType(routeMeta.getType());
            postcard.setPriority(routeMeta.getPriority());
            postcard.setExtra(routeMeta.getExtra());

            Uri rawUri = postcard.getUri();
            //通过Uri方式启动,会走下面的方法
            if (null != rawUri) {   // Try to set params into bundle.
                //.....
            }
            //根据routeMeta.getType()的值,进行处理,当前例子的值为ACTIVITY
            switch (routeMeta.getType()) {//当类型为PROVIDER/FRAGMENT时,设置为绿色通道,不需要走拦截器
                case PROVIDER:
                    postcard.greenChannel();
                    break;
                case FRAGMENT:
                        postcard.greenChannel();
            }
        }
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;"> public synchronized static void completion(Postcard postcard) {
        if (null == postcard) {
            throw new NoRouteFoundException(TAG + "No postcard!");
        }
        //根据"/test/activity2"为key,去map中找,看是否有对应的RouteMeta
        RouteMeta routeMeta = Warehouse.routes.get(postcard.getPath());
        if (null == routeMeta) {    // Maybe its does't exist, or didn't load.
               //如果,没有这个具体路径,就执行下面代码.
            //根据组名去寻找,组的文件
            Class&lt;? extends IRouteGroup&gt; groupMeta = Warehouse.groupsIndex.get(postcard.getGroup());  // Load route meta.
            if (null == groupMeta) {
                //当前组名没有获取到,会抛出如下错误
                throw new NoRouteFoundException(TAG + "There is no route match the path [" + postcard.getPath() + "], in group [" + postcard.getGroup() + "]");
            } else {
                // Load route and cache it into memory, then delete from metas.
                //获取到分组文件,groupMeta对应的文件为com.alibaba.android.arouter.routes.ARouter$$Group$$test
                try {
                    //....打印log
                    //获取这个文件,并实例出接口对象
                    IRouteGroup iGroupInstance = groupMeta.getConstructor().newInstance();
                    //向Warehouse.routes中加载"/test"分组下的数据
                    iGroupInstance.loadInto(Warehouse.routes);
                    //索引列表中移除当前信息,因为已经添加到内存中
                    Warehouse.groupsIndex.remove(postcard.getGroup());

                    //....打印log
                } catch (Exception e) {
                    throw new HandlerException(TAG + "Fatal exception when loading group meta. [" + e.getMessage() + "]");
                }
                //再一次调用compleyion(),此时Warehouse.routes中已经有"/test/activity2"对应界面的信息
                completion(postcard);   // Reload
            }
        } else {
            //第二次会走到这里,并对
            postcard.setDestination(routeMeta.getDestination());
            postcard.setType(routeMeta.getType());
            postcard.setPriority(routeMeta.getPriority());
            postcard.setExtra(routeMeta.getExtra());

            Uri rawUri = postcard.getUri();
            //通过Uri方式启动,会走下面的方法
            if (null != rawUri) {   // Try to set params into bundle.
                //.....
            }
            //根据routeMeta.getType()的值,进行处理,当前例子的值为ACTIVITY
            switch (routeMeta.getType()) {//当类型为PROVIDER/FRAGMENT时,设置为绿色通道,不需要走拦截器
                case PROVIDER:
                    postcard.greenChannel();
                    break;
                case FRAGMENT:
                        postcard.greenChannel();
            }
        }
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">completion 方法执行完毕,其中,主要做了两个功能:</p><ol style="list-style-type: decimal;">
<li style="display: list-item; line-height: 1.4em;">判断Warehouse.routes缓存中是否存在当前路径(‘/test/activity2’)的信息,不存在则添加,并重新调用自身方法</li><li style="display: list-item; line-height: 1.4em;">对Postcard的参数进行一些设置</li></ol><p style="margin: 1em 0px; word-wrap: break-word;">代码返回到</p><h5 id="_arouter->navigation(context,postcard,int,navigationcallback)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="_arouter->navigation(context,postcard,int,navigationcallback)" href="#_arouter-&gt;navigation(context,postcard,int,navigationcallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>_ARouter-&gt;navigation(Context,Postcard,int,NavigationCallback)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>protected Object navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback){//参数值 context:null;requestCode:-1;callback:null;
        LogisticsCenter.completion(postcard);
        //....
        if (!postcard.isGreenChannel()) {//如果不是绿色通道就先执行拦截器
            interceptorService.doInterceptions(postcard, new InterceptorCallback() {
                @Override
                public void onContinue(Postcard postcard) {
                    _navigation(context, postcard, requestCode, callback);
                }

                @Override
                public void onInterrupt(Throwable exception) {
                    if (null != callback) {
                        callback.onInterrupt(postcard);
                    }
                }
            });
        } else {
            return _navigation(context, postcard, requestCode, callback);
        }
        return null;
}
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">protected Object navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback){//参数值 context:null;requestCode:-1;callback:null;
        LogisticsCenter.completion(postcard);
        //....
        if (!postcard.isGreenChannel()) {//如果不是绿色通道就先执行拦截器
            interceptorService.doInterceptions(postcard, new InterceptorCallback() {
                @Override
                public void onContinue(Postcard postcard) {
                    _navigation(context, postcard, requestCode, callback);
                }

                @Override
                public void onInterrupt(Throwable exception) {
                    if (null != callback) {
                        callback.onInterrupt(postcard);
                    }
                }
            });
        } else {
            return _navigation(context, postcard, requestCode, callback);
        }
        return null;
}
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">按F5会跟入到doInterceptions()方法内,统一在这里处理拦截</p><h5 id="interceptorserviceimpl->dointerceptions(postcard,-interceptorcallback)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="interceptorserviceimpl->dointerceptions(postcard,-interceptorcallback)" href="#interceptorserviceimpl-&gt;dointerceptions(postcard,-interceptorcallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>InterceptorServiceImpl-&gt;doInterceptions(Postcard, InterceptorCallback)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>@Override
    public void doInterceptions(final Postcard postcard, final InterceptorCallback callback) {
        if (null != Warehouse.interceptors &amp;amp;&amp;amp; Warehouse.interceptors.size() &amp;gt; 0) {//拦截器集合不为空,并且拦截器数量大于0
            //校验
            checkInterceptorsInitStatus();

            if (!interceptorHasInit) {
                callback.onInterrupt(new HandlerException(&quot;Interceptors initialization takes too much time.&quot;));
                return;
            }

            //线程内执行
            LogisticsCenter.executor.execute(new Runnable() {
                @Override
                public void run() {
                    //线程同步辅助类,用来计次,等待
                    CancelableCountDownLatch interceptorCounter = new CancelableCountDownLatch(Warehouse.interceptors.size());
                    try {
                        //执行具体逻辑地方,详细解析在下方
                        _excute(0, interceptorCounter, postcard);
                        //设置超时时间,并等待
                        interceptorCounter.await(postcard.getTimeout(), TimeUnit.SECONDS);
                        if (异常条件) {
                            //....
                        } else {
                            callback.onContinue(postcard);//跳出拦截器,继续执行
                        }
                    } catch (Exception e) {
                        callback.onInterrupt(e);
                    }
                }
            });
        } else {
            callback.onContinue(postcard);//没有拦截器,直接直接执行
        }
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">@Override
    public void doInterceptions(final Postcard postcard, final InterceptorCallback callback) {
        if (null != Warehouse.interceptors &amp;&amp; Warehouse.interceptors.size() &gt; 0) {//拦截器集合不为空,并且拦截器数量大于0
            //校验
            checkInterceptorsInitStatus();

            if (!interceptorHasInit) {
                callback.onInterrupt(new HandlerException("Interceptors initialization takes too much time."));
                return;
            }

            //线程内执行
            LogisticsCenter.executor.execute(new Runnable() {
                @Override
                public void run() {
                    //线程同步辅助类,用来计次,等待
                    CancelableCountDownLatch interceptorCounter = new CancelableCountDownLatch(Warehouse.interceptors.size());
                    try {
                        //执行具体逻辑地方,详细解析在下方
                        _excute(0, interceptorCounter, postcard);
                        //设置超时时间,并等待
                        interceptorCounter.await(postcard.getTimeout(), TimeUnit.SECONDS);
                        if (异常条件) {
                            //....
                        } else {
                            callback.onContinue(postcard);//跳出拦截器,继续执行
                        }
                    } catch (Exception e) {
                        callback.onInterrupt(e);
                    }
                }
            });
        } else {
            callback.onContinue(postcard);//没有拦截器,直接直接执行
        }
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">doInterceptions方法,主要做了三个工作</p><ol style="list-style-type: decimal;">
<li style="display: list-item; line-height: 1.4em;">校验</li><li style="display: list-item; line-height: 1.4em;">线程内执行并等待结束</li><li style="display: list-item; line-height: 1.4em;">线程内递归调用</li></ol><p style="margin: 1em 0px; word-wrap: break-word;">继续看_excute()执行过程</p><h5 id="interceptorserviceimpl->_excute(int,-cancelablecountdownlatch,postcard)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="interceptorserviceimpl->_excute(int,-cancelablecountdownlatch,postcard)" href="#interceptorserviceimpl-&gt;_excute(int,-cancelablecountdownlatch,postcard)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>InterceptorServiceImpl-&gt;_excute(int, CancelableCountDownLatch,Postcard)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>    //参数:索引,辅助工具类,目标界面的Postcard
    private static void _excute(final int index, final CancelableCountDownLatch counter, final Postcard postcard) {
        //判断缓存总拦截器数量是否大于索引数
        if (index &amp;lt; Warehouse.interceptors.size()) {
            //根据索引获取拦截器
            IInterceptor iInterceptor = Warehouse.interceptors.get(index);
            //调用用户自定义拦截器内的方法,在arouter-demo中,用户自定义的拦截器是Test1Interceptor,
            iInterceptor.process(postcard, new InterceptorCallback() {
                @Override
                public void onContinue(Postcard postcard) {
                    //执行过用户自定义的拦截器后,执行这里
                    //线程同步工具计次减一
                    counter.countDown();
                    //递归调用自己,判断下一个拦截器
                    _excute(index + 1, counter, postcard);
                }

                @Override
                public void onInterrupt(Throwable exception) {
                   //被拦截之后的处理
                    postcard.setTag(null == exception ? new HandlerException(&quot;No message.&quot;) : exception.getMessage());
                    counter.cancel();
                }
            });
        }
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">    //参数:索引,辅助工具类,目标界面的Postcard
    private static void _excute(final int index, final CancelableCountDownLatch counter, final Postcard postcard) {
        //判断缓存总拦截器数量是否大于索引数
        if (index &lt; Warehouse.interceptors.size()) {
            //根据索引获取拦截器
            IInterceptor iInterceptor = Warehouse.interceptors.get(index);
            //调用用户自定义拦截器内的方法,在arouter-demo中,用户自定义的拦截器是Test1Interceptor,
            iInterceptor.process(postcard, new InterceptorCallback() {
                @Override
                public void onContinue(Postcard postcard) {
                    //执行过用户自定义的拦截器后,执行这里
                    //线程同步工具计次减一
                    counter.countDown();
                    //递归调用自己,判断下一个拦截器
                    _excute(index + 1, counter, postcard);
                }

                @Override
                public void onInterrupt(Throwable exception) {
                   //被拦截之后的处理
                    postcard.setTag(null == exception ? new HandlerException("No message.") : exception.getMessage());
                    counter.cancel();
                }
            });
        }
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">_excute方法就是递归自己,然后调用用户定义的拦截器,让用户去判断是否拦截,或者执行其他操作</p><p style="margin: 1em 0px; word-wrap: break-word;">看下Test1Interceptor中怎么处理的</p><h5 id="test1interceptor->process(postcard,interceptorcallback)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="test1interceptor->process(postcard,interceptorcallback)" href="#test1interceptor-&gt;process(postcard,interceptorcallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>Test1Interceptor-&gt;process(Postcard,InterceptorCallback)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>  @Override
    public void process(final Postcard postcard, final InterceptorCallback callback) {
        if (&quot;/test/activity4&quot;.equals(postcard.getPath())) {
            //让用户自主选择是否拦截

            //不拦截
            //callback.onContinue(postcard);
            //拦截
            //callback.onInterrupt(null);
            //添加参数
            //postcard.withString(&quot;extra&quot;, &quot;我是在拦截器中附加的参数&quot;);
            //callback.onContinue(postcard);
        } else {
            //执行这里,不拦截
            callback.onContinue(postcard);
        }
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">  @Override
    public void process(final Postcard postcard, final InterceptorCallback callback) {
        if ("/test/activity4".equals(postcard.getPath())) {
            //让用户自主选择是否拦截

            //不拦截
            //callback.onContinue(postcard);
            //拦截
            //callback.onInterrupt(null);
            //添加参数
            //postcard.withString("extra", "我是在拦截器中附加的参数");
            //callback.onContinue(postcard);
        } else {
            //执行这里,不拦截
            callback.onContinue(postcard);
        }
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">总结一下这里执行的顺序</p><ol style="list-style-type: decimal;">
<li style="display: list-item; line-height: 1.4em;">从<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">doInterceptions()</code>开始执行拦截器<br style="clear: both;"> (1) 校验<br style="clear: both;"> (2) 在线程池内调用<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_excute()</code>方法</li><li style="display: list-item; line-height: 1.4em;">执行 <code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_excute()</code>方法<br style="clear: both;"> (1) 根据索引获取拦截器<br style="clear: both;"> (2) 拔处理工作交给用户自定义的拦截器</li><li style="display: list-item; line-height: 1.4em;">执行用户自定义拦截器的<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">process</code>方法<br style="clear: both;">  (1) 用户拦截 : 执行2.(2) <code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_excute()</code>中拦截器的回调方法<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">onInterrupt()</code><br style="clear: both;"> (2) 用户不拦截 : 执行2.(2)接下来的代码,计次减一,递归<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_excute()</code>方法</li></ol><p style="margin: 1em 0px; word-wrap: break-word;">当循环过所有拦截器以后,会调用<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">doInterceptions()</code>的回调,如果用户不打算拦截,将执行<code style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-family: Consolas, 'Liberation Mono', Menlo, Courier, monospace; font-size: 85%; padding: 0.2em 0.5em; border: 1px solid rgb(239, 239, 239); background-color: rgba(0, 0, 0, 0.0196078);">_navigation</code>方法</p><h5 id="_arouter->_navigation(context,postcard,int,navigationcallback)" style="clear: both;font-size: 1.2em; font-weight: bold; margin: 0.855em 0px 0.57em;"><a name="_arouter->_navigation(context,postcard,int,navigationcallback)" href="#_arouter-&gt;_navigation(context,postcard,int,navigationcallback)" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>_ARouter-&gt;_navigation(Context,Postcard,int,NavigationCallback)</h5><pre style="border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); overflow: auto; padding: 0.5em;"><code data-origin="<pre><code>private Object _navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback) {
        switch (postcard.getType()) {
            case ACTIVITY:
                //实例化intent,添加参数,进行跳转
                break;
            case FRAGMENT:
                //实例化Fragment,并返回
        }
        return null;
    }
</code></pre>" style="border: 0px; display: block;font-family: Consolas, Inconsolata, Courier, monospace; font-weight: bold; white-space: pre; margin: 0px;border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; word-wrap: break-word; border: 1px solid rgb(204, 204, 204); padding: 0px 5px; margin: 0px 2px;font-size: 1em; letter-spacing: -1px; font-weight: bold;">private Object _navigation(final Context context, final Postcard postcard, final int requestCode, final NavigationCallback callback) {
        switch (postcard.getType()) {
            case ACTIVITY:
                //实例化intent,添加参数,进行跳转
                break;
            case FRAGMENT:
                //实例化Fragment,并返回
        }
        return null;
    }
</code></pre><p style="margin: 1em 0px; word-wrap: break-word;">跳转完成!</p><h2 id="end" style="clear: both;font-size: 1.8em; font-weight: bold; margin: 1.275em 0px 0.85em;border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(230, 230, 230);"><a name="end" href="#end" style="text-decoration: none; vertical-align: baseline;color: rgb(50, 105, 160);"></a>END</h2><p style="margin-top: 0px;margin: 1em 0px; word-wrap: break-word;">这套代码还是很好分析的,如果哪里写的不清楚或错误了,请联系我</p><ul>
<li style="display: list-item; line-height: 1.4em;">邮件(chenxingyu1112@gmail.com)</li><li style="display: list-item; line-height: 1.4em;">QQ: 1209101049</li></ul></div>

</body>
</html>

